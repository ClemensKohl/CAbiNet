<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='`caclust()` performs biclustering on either a "cacomp" or
"SingleCellExperiment" object.'><title>caclust — caclust • CAbiNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="caclust — caclust"><meta property="og:description" content='`caclust()` performs biclustering on either a "cacomp" or
"SingleCellExperiment" object.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CAbiNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/CAbiNet.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>caclust</h1>
      
      <div class="d-none name"><code>caclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`caclust()` performs biclustering on either a "cacomp" or
"SingleCellExperiment" object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">caclust</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"leiden"</span>,</span>
<span>  SNN_prune <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">15</span>,</span>
<span>  loops <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"out"</span>,</span>
<span>  select_genes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prune_overlap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overlap <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  calc_gene_cell_kNN <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  marker_genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.int <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  rand_seed <span class="op">=</span> <span class="fl">2358</span>,</span>
<span>  use_gap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nclust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spectral_method <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span>  iter_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  num_seeds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  return_eig <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cast_to_dense <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for cacomp</span></span>
<span><span class="fu">caclust</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"leiden"</span>,</span>
<span>  SNN_prune <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">15</span>,</span>
<span>  loops <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"out"</span>,</span>
<span>  select_genes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prune_overlap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overlap <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  calc_gene_cell_kNN <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  marker_genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.int <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  rand_seed <span class="op">=</span> <span class="fl">2358</span>,</span>
<span>  use_gap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nclust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spectral_method <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span>  iter_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  num_seeds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  return_eig <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cast_to_dense <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu">BiocNeighbors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocNeighbors/man/KmknnParam.html" class="external-link">KmknnParam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  leiden_pack <span class="op">=</span> <span class="st">"igraph"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SingleCellExperiment</span></span>
<span><span class="fu">caclust</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="st">"leiden"</span>,</span>
<span>  SNN_prune <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">15</span>,</span>
<span>  loops <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"out"</span>,</span>
<span>  select_genes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prune_overlap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overlap <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  calc_gene_cell_kNN <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  marker_genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.int <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  rand_seed <span class="op">=</span> <span class="fl">2358</span>,</span>
<span>  use_gap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nclust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spectral_method <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span>  iter_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  num_seeds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  return_eig <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cast_to_dense <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu">BiocNeighbors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocNeighbors/man/KmknnParam.html" class="external-link">KmknnParam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  leiden_pack <span class="op">=</span> <span class="st">"igraph"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  caclust_meta_name <span class="op">=</span> <span class="st">"caclust"</span>,</span>
<span>  cacomp_meta_name <span class="op">=</span> <span class="st">"CA"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obj</dt>
<dd><p>A cacomp object or SingleCellExperiment object</p></dd>


<dt>k</dt>
<dd><p>Either an integer (same k for all subgraphs) or a vector of
exactly four integers specifying in this order: the k_c for the cell-cell
kNN-graph, k_g for the gene-gene kNN-graph, k_cg for the cell-gene
kNN-graph, k_gc for the gene-cell kNN-graph.</p></dd>


<dt>algorithm</dt>
<dd><p>Character. Algorithm for clustering. Options are "leiden" or "spectral". Defalut: 'leiden'.</p></dd>


<dt>SNN_prune</dt>
<dd><p>numeric. Value between 0-1. Sets cutoff of acceptable jaccard
similarity scores for neighborhood overlap of vertices in SNN. Edges with values
less than this will be set as 0. The default value is 1/15.</p></dd>


<dt>loops</dt>
<dd><p>TRUE/FALSE. If TRUE self-loops are allowed, otherwise not.</p></dd>


<dt>mode</dt>
<dd><p>The type of neighboring vertices to use for calculating similarity
scores(Jaccard Index). Three options: "out", "in" and "all":</p><ul><li><p>"out": Selecting neighbouring vertices by out-going edges;</p></li>
<li><p>"in": Selecting neighbouring vertices by in-coming edges;</p></li>
<li><p>"all": Selecting neigbouring vertices by both in-coming and out-going edges.</p></li>
</ul></dd>


<dt>select_genes</dt>
<dd><p>TRUE/FALSE. Should genes be selected by whether they have
an edge in the cell-gene kNN graph?</p></dd>


<dt>prune_overlap</dt>
<dd><p>TRUE/FALSE. If TRUE edges to genes that share less
than <code>overlap</code> of genes with the nearest neighbours of the cell are removed.
Pruning is only performed if select_genes = TRUE.</p></dd>


<dt>overlap</dt>
<dd><p>Numeric between 0 and 1. Overlap cutoff applied if
prune_overlap = TRUE.</p></dd>


<dt>calc_gene_cell_kNN</dt>
<dd><p>TRUE/FALSE. If TRUE a cell-gene graph is calculated
by choosing the <code>k_gc</code> nearest cells for each gene. If FALSE the cell-gene
graph is transposed.</p></dd>


<dt>resolution</dt>
<dd><p>float number. Resolution for leiden algorithm.</p></dd>


<dt>marker_genes</dt>
<dd><p>character. Optional. Names of known marker genes that
should be excempt from any pruning on the graph and be kept.</p></dd>


<dt>n.int</dt>
<dd><p>Integer. Number of iterations for leiden algorithm.</p></dd>


<dt>rand_seed</dt>
<dd><p>integer. Random seed.</p></dd>


<dt>use_gap</dt>
<dd><p>Logical, TRUE/FALSE. If TRUE, 'eigengap' method will be used to find the
most important eigenvector automatically, and the number of output clusters
equals number of selected eigenvectors. If FALSE, 'nclust'(integer) should be specified.
The eigenvectors corresponding with the smallest 'nclust' eigenvalues will be
selcted and 'nclust' clusters will be detected by skmeans/kmeans/GMM.</p></dd>


<dt>nclust</dt>
<dd><p>Integer. Number of clusters.</p></dd>


<dt>spectral_method</dt>
<dd><p>character. Name of the method to cluster the eigenvectors.
Can be on of the following 3:</p><ul><li><p>"kmeans": k-means clustering</p></li>
<li><p>"skmeans": spherical k-means clustering</p></li>
<li><p>"GMM": Gaussian-Mixture-Model fuzzy clustering.</p></li>
</ul></dd>


<dt>iter_max</dt>
<dd><p>Number of iterations for k-means clustering and GMM.</p></dd>


<dt>num_seeds</dt>
<dd><p>Number of times k-means clustering is repeated.</p></dd>


<dt>return_eig</dt>
<dd><p>Logical. Whether or not to return eigenvectors and store them in caclust-object.</p></dd>


<dt>dims</dt>
<dd><p>Integer. Number of dimensions to choose from SVD of graph laplacian.</p></dd>


<dt>cast_to_dense</dt>
<dd><p>logical. Casting sparse SNN adjacency matrix to dense speeds up the leiden algorithm.</p></dd>


<dt>...</dt>
<dd><p>further arguments</p></dd>


<dt>method</dt>
<dd><p><a href="https://rdrr.io/pkg/BiocNeighbors/man/BiocNeighborParam.html" class="external-link">BiocNeighbors::BiocNeighborParam</a> object specifying the
algorithm to use. see Details.</p></dd>


<dt>BPPARAM</dt>
<dd><p>BiocParallel settings parameter. By default single core
<code><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">BiocParallel::SerialParam()</a></code> but other parameters can be passed.</p></dd>


<dt>leiden_pack</dt>
<dd><p>character. Optional values are 'igraph'(default) and 'leiden', the package used for leiden clustering.</p></dd>


<dt>caclust_meta_name</dt>
<dd><p>the name of caclust object stored in
metadata(SingleCellExperiment object). Default: 'caclust.'</p></dd>


<dt>cacomp_meta_name</dt>
<dd><p>Character. The name of cacomp object stored in
metadata(SingleCellExperiment object). Default: 'caobj'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A caclust object or SingleCellExperiment object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Convenient wrapper around `make_SNN` and `run_leiden`/`run_spectral`.
`run_caclust` takes a cacomp object and biclusters cells and genes.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other biclustering: 
<code><a href="make_SNN.html">make_SNN</a>()</code>,
<code><a href="run_leiden.html">run_leiden</a>()</code>,
<code><a href="run_spectral.html">run_spectral</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Clemens Kohl, Yan Zhao, Martin Vingron.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

